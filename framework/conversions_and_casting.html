

<!DOCTYPE html>
<html lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Conversions and Casting &mdash; mp-units 0.6.0 documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/graphviz.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/custom.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Text Output" href="text_output.html" />
    <link rel="prev" title="Quantity Constants" href="constants.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home" alt="Documentation Home"> mp-units
          

          
          </a>

          
            
            
              <div class="version">
                0.6.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Getting Started:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../quick_start.html">Quick Start</a></li>
<li class="toctree-l1"><a class="reference internal" href="../usage.html">Usage</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../framework.html">Framework Basics</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="basic_concepts.html">Basic Concepts</a></li>
<li class="toctree-l2"><a class="reference internal" href="quantities.html">Quantities</a></li>
<li class="toctree-l2"><a class="reference internal" href="dimensions.html">Dimensions</a></li>
<li class="toctree-l2"><a class="reference internal" href="units.html">Units</a></li>
<li class="toctree-l2"><a class="reference internal" href="constants.html">Quantity Constants</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Conversions and Casting</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#no-conversions">No Conversions</a></li>
<li class="toctree-l3"><a class="reference internal" href="#implicit">Implicit</a></li>
<li class="toctree-l3"><a class="reference internal" href="#explicit">Explicit</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#quantity-cast-overloads">Quantity Cast Overloads</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="text_output.html">Text Output</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../use_cases.html">Use Cases</a></li>
<li class="toctree-l1"><a class="reference internal" href="../design.html">Design Deep Dive</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq.html">FAQ</a></li>
</ul>
<p class="caption"><span class="caption-text">Reference:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../reference/concepts.html">Concepts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/types.html">Types</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/functions.html">Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/metafunctions.html">Metafunctions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/customization_points.html">Customization Points</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/systems.html">Systems</a></li>
</ul>
<p class="caption"><span class="caption-text">Appendix:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../glossary.html">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../genindex.html">Index</a></li>
<li class="toctree-l1"><a class="reference internal" href="../CHANGELOG.html">Release notes</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">mp-units</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../framework.html">Framework Basics</a> &raquo;</li>
        
      <li>Conversions and Casting</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/framework/conversions_and_casting.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="conversions-and-casting">
<h1>Conversions and Casting<a class="headerlink" href="#conversions-and-casting" title="Permalink to this headline">¶</a></h1>
<blockquote>
<div><p>Programmers who are not full-time programming language geeks <strong>hate lack of
implicit conversions</strong> that they consider reasonable. Violate their expectations
for reasons they consider hypothetical problems and you get disuse. In type
terms, I usually <strong>translate “reasonable” to “not narrowing” aka “not loosing
information.”</strong> That can reasonably easily be explained to non-language-experts.</p>
<p class="attribution">—<em>Bjarne Stroustrup</em></p>
</div></blockquote>
<p>The library tries to follow the above principle and at the same time is also consistent
with conversions of <code class="docutils literal notranslate"><span class="pre">std::chrono::duration</span></code>.</p>
<div class="section" id="no-conversions">
<h2>No Conversions<a class="headerlink" href="#no-conversions" title="Permalink to this headline">¶</a></h2>
<p>No conversions (either implicit or explicit) are available across quantities of
different dimensions:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">si</span><span class="o">::</span><span class="n">length</span><span class="o">&lt;</span><span class="n">si</span><span class="o">::</span><span class="n">metre</span><span class="o">&gt;</span> <span class="n">d1</span> <span class="o">=</span> <span class="mi">1</span><span class="n">q_s</span><span class="p">;</span>            <span class="c1">// Compile-time error</span>
<span class="n">si</span><span class="o">::</span><span class="n">length</span><span class="o">&lt;</span><span class="n">si</span><span class="o">::</span><span class="n">metre</span><span class="o">&gt;</span> <span class="n">d2</span><span class="p">(</span><span class="mi">1</span><span class="n">q_s</span><span class="p">);</span>             <span class="c1">// Compile-time error</span>
<span class="k">auto</span> <span class="n">d3</span> <span class="o">=</span> <span class="n">quantity_cast</span><span class="o">&lt;</span><span class="n">si</span><span class="o">::</span><span class="n">metre</span><span class="o">&gt;</span><span class="p">(</span><span class="mi">1</span><span class="n">q_s</span><span class="p">);</span>   <span class="c1">// Compile-time error</span>
</pre></div>
</div>
</div>
<div class="section" id="implicit">
<h2>Implicit<a class="headerlink" href="#implicit" title="Permalink to this headline">¶</a></h2>
<p>Implicit conversions are allowed only across quantities of the same dimension:</p>
<ul>
<li><p>for integral types with ratios that guarantee no precision loss:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">si</span><span class="o">::</span><span class="n">length</span><span class="o">&lt;</span><span class="n">si</span><span class="o">::</span><span class="n">metre</span><span class="p">,</span> <span class="kt">int</span><span class="o">&gt;</span>        <span class="n">d1</span> <span class="o">=</span> <span class="mi">1</span><span class="n">q_km</span> <span class="o">+</span> <span class="mi">1</span><span class="n">q_m</span><span class="p">;</span>  <span class="c1">// OK</span>
<span class="n">si</span><span class="o">::</span><span class="n">length</span><span class="o">&lt;</span><span class="n">si</span><span class="o">::</span><span class="n">millimetre</span><span class="p">,</span> <span class="kt">int</span><span class="o">&gt;</span>   <span class="n">d2</span> <span class="o">=</span> <span class="mi">1</span><span class="n">q_km</span> <span class="o">+</span> <span class="mi">1</span><span class="n">q_m</span><span class="p">;</span>  <span class="c1">// OK</span>
<span class="n">si</span><span class="o">::</span><span class="n">length</span><span class="o">&lt;</span><span class="n">si</span><span class="o">::</span><span class="n">kilometre</span><span class="p">,</span> <span class="kt">int</span><span class="o">&gt;</span>    <span class="n">d3</span> <span class="o">=</span> <span class="mi">1</span><span class="n">q_km</span> <span class="o">+</span> <span class="mi">1</span><span class="n">q_m</span><span class="p">;</span>  <span class="c1">// Compile-time error</span>
<span class="n">si</span><span class="o">::</span><span class="n">length</span><span class="o">&lt;</span><span class="n">si</span><span class="o">::</span><span class="n">kilometre</span><span class="p">,</span> <span class="kt">int</span><span class="o">&gt;</span>    <span class="n">d4</span><span class="p">(</span><span class="mi">1</span><span class="n">q_km</span> <span class="o">+</span> <span class="mi">1</span><span class="n">q_m</span><span class="p">);</span>   <span class="c1">// Compile-time error</span>
<span class="n">si</span><span class="o">::</span><span class="n">length</span><span class="o">&lt;</span><span class="n">si</span><span class="o">::</span><span class="n">metre</span><span class="p">,</span> <span class="kt">int</span><span class="o">&gt;</span>        <span class="n">d5</span> <span class="o">=</span> <span class="mi">1</span><span class="n">q_m</span> <span class="o">+</span> <span class="mi">1</span><span class="n">q_ft</span><span class="p">;</span>  <span class="c1">// Compile-time error</span>
<span class="n">si</span><span class="o">::</span><span class="n">length</span><span class="o">&lt;</span><span class="n">si</span><span class="o">::</span><span class="n">metre</span><span class="p">,</span> <span class="kt">int</span><span class="o">&gt;</span>        <span class="n">d6</span><span class="p">(</span><span class="mi">1</span><span class="n">q_m</span> <span class="o">+</span> <span class="mi">1</span><span class="n">q_ft</span><span class="p">);</span>   <span class="c1">// Compile-time error</span>
</pre></div>
</div>
</li>
<li><p>from an integral to a floating-point representation even in case of a truncating
ratio:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">si</span><span class="o">::</span><span class="n">length</span><span class="o">&lt;</span><span class="n">si</span><span class="o">::</span><span class="n">kilometre</span><span class="p">,</span> <span class="kt">double</span><span class="o">&gt;</span> <span class="n">d7</span> <span class="o">=</span> <span class="mi">1</span><span class="n">q_km</span> <span class="o">+</span> <span class="mi">1</span><span class="n">q_m</span><span class="p">;</span>  <span class="c1">// OK</span>
<span class="n">si</span><span class="o">::</span><span class="n">length</span><span class="o">&lt;</span><span class="n">si</span><span class="o">::</span><span class="n">metre</span><span class="p">,</span> <span class="kt">double</span><span class="o">&gt;</span>     <span class="n">d8</span> <span class="o">=</span> <span class="mi">1</span><span class="n">q_m</span> <span class="o">+</span> <span class="mi">1</span><span class="n">q_ft</span><span class="p">;</span>  <span class="c1">// OK</span>
</pre></div>
</div>
</li>
<li><p>when both sides use a floating-point representation:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">si</span><span class="o">::</span><span class="n">length</span><span class="o">&lt;</span><span class="n">si</span><span class="o">::</span><span class="n">metre</span><span class="p">,</span> <span class="kt">int</span><span class="o">&gt;</span>        <span class="n">d9</span> <span class="o">=</span> <span class="mf">1.23</span><span class="n">q_m</span><span class="p">;</span>       <span class="c1">// Compile-time error</span>
<span class="n">si</span><span class="o">::</span><span class="n">length</span><span class="o">&lt;</span><span class="n">si</span><span class="o">::</span><span class="n">metre</span><span class="p">,</span> <span class="kt">double</span><span class="o">&gt;</span>    <span class="n">d10</span> <span class="o">=</span> <span class="mf">1.23</span><span class="n">q_m</span><span class="p">;</span>       <span class="c1">// OK</span>
</pre></div>
</div>
</li>
</ul>
</div>
<div class="section" id="explicit">
<h2>Explicit<a class="headerlink" href="#explicit" title="Permalink to this headline">¶</a></h2>
<p>Explicit conversions are available with a <code class="xref cpp cpp-any docutils literal notranslate"><span class="pre">quantity_cast</span></code> function template. They
are especially useful to force a truncating conversion across quantities of the same
dimension for integral representation types and ratios that may cause precision loss:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">si</span><span class="o">::</span><span class="n">length</span><span class="o">&lt;</span><span class="n">si</span><span class="o">::</span><span class="n">kilometre</span><span class="p">,</span> <span class="kt">int</span><span class="o">&gt;</span> <span class="n">d1</span> <span class="o">=</span> <span class="n">quantity_cast</span><span class="o">&lt;</span><span class="n">kilometre</span><span class="o">&gt;</span><span class="p">(</span><span class="mi">1</span><span class="n">km</span> <span class="o">+</span> <span class="mi">1</span><span class="n">m</span><span class="p">);</span>    <span class="c1">// OK</span>
<span class="n">si</span><span class="o">::</span><span class="n">length</span><span class="o">&lt;</span><span class="n">si</span><span class="o">::</span><span class="n">kilometre</span><span class="p">,</span> <span class="kt">int</span><span class="o">&gt;</span> <span class="n">d2</span> <span class="o">=</span> <span class="n">quantity_cast</span><span class="o">&lt;</span><span class="n">kilometre</span><span class="o">&gt;</span><span class="p">(</span><span class="mi">1</span><span class="n">s</span><span class="p">);</span>          <span class="c1">// Error</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>Explicit casts are also really useful when working with legacy interfaces. More
information on this subject can be found in <a class="reference internal" href="../use_cases/legacy_interfaces.html#working-with-legacy-interfaces"><span class="std std-ref">Working with Legacy Interfaces</span></a>
chapter.</p>
</div>
<div class="section" id="quantity-cast-overloads">
<h3>Quantity Cast Overloads<a class="headerlink" href="#quantity-cast-overloads" title="Permalink to this headline">¶</a></h3>
<p><code class="xref cpp cpp-any docutils literal notranslate"><span class="pre">quantity_cast</span></code> comes with several overloads:</p>
<div class="highlight-cpp notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Distance: &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">quantity_cast</span><span class="o">&lt;</span><span class="n">si</span><span class="o">::</span><span class="n">length</span><span class="o">&lt;</span><span class="n">si</span><span class="o">::</span><span class="n">metre</span><span class="p">,</span> <span class="kt">int</span><span class="o">&gt;&gt;</span><span class="p">(</span><span class="n">d</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="sc">&#39;\n&#39;</span><span class="p">;</span>
<span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Distance: &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">quantity_cast</span><span class="o">&lt;</span><span class="n">si</span><span class="o">::</span><span class="n">metre</span><span class="o">&gt;</span><span class="p">(</span><span class="n">d</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="sc">&#39;\n&#39;</span><span class="p">;</span>
<span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Distance: &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">quantity_cast</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="p">(</span><span class="n">d</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="sc">&#39;\n&#39;</span><span class="p">;</span>
</pre></div>
</td></tr></table></div>
<p><code class="xref cpp cpp-any docutils literal notranslate"><span class="pre">quantity_cast</span></code> in line #1 takes a specific target <a class="reference internal" href="../reference/types/quantity.html#_CPPv4I_9Dimension_6UnitOfI1DE_6ScalarEN5units8quantityE" title="units::quantity"><code class="xref cpp cpp-any docutils literal notranslate"><span class="pre">quantity</span></code></a> type to which an explicit
cast should be performed. This option will change multiple quantity properties at once
(unit, representation, etc). However, it is also possible to force only one property at
once and leave the rest intact:</p>
<ul class="simple">
<li><p>line #2 forces only a specific destination unit type,</p></li>
<li><p>line #3 sets only a representation type to the type provided by the user.</p></li>
</ul>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>For more information on conversion and casting and on how to extend the above “integral”
vs “floating-point” logic please refer to the <a class="reference internal" href="../use_cases/custom_representation_types.html#using-custom-representation-types"><span class="std std-ref">Using Custom Representation Types</span></a>
chapter.</p>
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="text_output.html" class="btn btn-neutral float-right" title="Text Output" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="constants.html" class="btn btn-neutral float-left" title="Quantity Constants" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2018-present, Mateusz Pusz

    </p>
  </div>
    
    
      Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>